<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>YourGame - Auth</title>
		<link rel="stylesheet" href="auth.css" />
		<!-- Include Supabase client (for auth calls) -->
		<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
	</head>
	<body>
		<div class="auth-container">
			<!-- BRAND / WEB NAME (placeholder) -->
			<h1 class="brand-name">[YourGame]</h1>

			<!-- LOGIN CARD -->
			<div class="auth-box" id="loginBox">
				<h2>Login</h2>
				<form>
					<input type="email" id="loginEmail" placeholder="Email" required />
					<input
						type="password"
						id="loginPassword"
						placeholder="Password"
						required
					/>
					<button type="button" id="loginBtn">Log In</button>
				</form>
				<a href="#" class="forgot-password">Forgot your password?</a>
				<p class="toggle-link">
					Don't have an account?
					<a href="#" id="showRegister">Register here</a>
				</p>
			</div>

			<!-- REGISTER CARD (hidden by default) -->
			<div class="auth-box" id="registerBox">
				<h2>Register</h2>
				<form>
					<input type="email" id="registerEmail" placeholder="Email" required />
					<input
						type="password"
						id="registerPassword"
						placeholder="Password"
						required
					/>
					<button type="button" id="registerBtn">Register</button>
				</form>
				<p class="toggle-link">
					Already have an account?
					<a href="#" id="showLogin">Log in here</a>
				</p>
			</div>
		</div>

		<script type="module">
			import { supabaseClient } from "./js/supabaseClient.js";

			// Toggle between login and register boxes
			const loginBox = document.getElementById("loginBox");
			const registerBox = document.getElementById("registerBox");
			const showRegister = document.getElementById("showRegister");
			const showLogin = document.getElementById("showLogin");

			showRegister.addEventListener("click", (e) => {
				e.preventDefault();
				loginBox.style.display = "none";
				registerBox.style.display = "block";
			});

			showLogin.addEventListener("click", (e) => {
				e.preventDefault();
				registerBox.style.display = "none";
				loginBox.style.display = "block";
			});

			// Handle login button click
			document
				.getElementById("loginBtn")
				.addEventListener("click", async () => {
					const email = document.getElementById("loginEmail").value;
					const password = document.getElementById("loginPassword").value;
					const { data, error } = await supabaseClient.auth.signInWithPassword({
						email,
						password,
					});
					if (error) {
						alert("Login Error: " + error.message);
					} else {
						alert("Login successful!");
						localStorage.setItem("isLoggedIn", "true");
						window.location.href = "index.html";
					}
				});

			// Handle register button click
			document
				.getElementById("registerBtn")
				.addEventListener("click", async () => {
					const email = document.getElementById("registerEmail").value;
					const password = document.getElementById("registerPassword").value;
					const { data, error } = await supabaseClient.auth.signUp({
						email,
						password,
					});
					if (error) {
						alert("Registration Error: " + error.message);
					} else {
						alert("Registration successful!");
					}
				});
		</script>
	</body>
</html>
